{"is_source_file": true, "format": "C++", "description": "This source file implements a sophisticated system call tracer and thread tracker for a file access visualization tool. It uses ptrace to monitor system calls, handle process and thread lifecycle events, resolve file paths, and record file operations for visualization through generated HTML reports.", "external_files": ["path_utils.hpp", "directory_tree.hpp", "html_generator.hpp", "logger.hpp"], "external_methods": ["path_utils::normalize_path", "path_utils::is_within_directory", "path_utils::get_current_directory", "HtmlGenerator::generate_html_report", "Logger::debug", "Logger::error", "Logger::info", "Logger::warning"], "published": ["FILETRACE_VERSION"], "classes": [{"name": "ProcessType", "description": "Enum to distinguish between processes and threads"}, {"name": "ThreadInfo", "description": "Structure to store thread or process information including IDs, name, parent, activity status, and hierarchy"}, {"name": "FileOperation", "description": "Structure to record details of a file operation, such as path, pid, thread, sequence, and whether it's an actual open"}], "methods": [{"name": "std::string get_thread_name(pid_t tid)", "description": "Retrieve the thread or process name from /proc/<tid>/comm", "scope": "", "scopeKind": ""}, {"name": "void handle_thread_creation(pid_t parent_pid,pid_t thread_id,bool is_process=false)", "description": "Create or update thread/process info in thread_map, attach parent-child relationships", "scope": "", "scopeKind": ""}, {"name": "void handle_thread_exit(pid_t thread_id,int exit_status=0)", "description": "Mark thread or process as inactive, perform cleanup and detach ptrace", "scope": "", "scopeKind": ""}, {"name": "std::string resolve_fd_path(pid_t pid,int fd)", "description": "Resolve symbolic links in /proc/<pid>/fd/<fd> to get actual file path", "scope": "", "scopeKind": ""}, {"name": "std::string resolve_relative_path(const std::string & base_path,const std::string & relative_path)", "description": "Compute absolute path from base directory and relative filename", "scope": "", "scopeKind": ""}, {"name": "std::string read_process_string(pid_t pid,unsigned long addr)", "description": "Safely read a null-terminated string from a process's memory using ptrace", "scope": "", "scopeKind": ""}, {"name": "void handle_syscall_entry(pid_t pid,const user_regs_struct & regs,std::vector<FileOperation> & operations,const std::string & base_dir=\"\")", "description": "Process system call entries to handle clone, open, execve, setting thread info and recording file access", "scope": "", "scopeKind": ""}, {"name": "void generate_html_output(const std::vector<FileOperation> & operations,const std::string & output_file)", "description": "Build directory tree structure and generate visualization HTML report", "scope": "", "scopeKind": ""}, {"name": "bool validate_output_file(const std::string & path)", "description": "Check if output path exists, is writable, and accessible", "scope": "", "scopeKind": ""}, {"name": "bool validate_command(const std::string & command)", "description": "Verify the specified command exists and is executable, searching in PATH if needed", "scope": "", "scopeKind": ""}, {"name": "void display_help(const cxxopts::Options & options)", "description": "Print command-line help message with usage examples", "scope": "", "scopeKind": ""}, {"name": "int main(int argc,char * argv[])", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["ptrace", "waitpid", "kill", "stat", "access", "execvp", "ptrace(PTRACE_GETREGS)", "ptrace(PTRACE_SETOPTIONS)", "ptrace(PTRACE_SYSCALL)", "ptrace(PTRACE_DETACH)", "readlink", "std::filesystem::exists", "std::filesystem::is_directory", "std::filesystem::status", "getenv", "kill", "usleep", "raise", "exit", "std::remove", "kill", "waitpid", "signal", "empty", "strerror"], "search-terms": ["system call tracing", "thread/process hierarchy", "file path resolution", "ptrace error recovery", "HTML report generation", "file operation tracking", "process clone/fork events", "file access visualization", "directory traversal", "multi-threaded ptrace handling"], "state": 2, "file_id": 44, "knowledge_revision": 190, "git_revision": "752b0fb5cc733008c1ffde3c54134ff699070bc7", "ctags": [{"_type": "tag", "name": "FILETRACE_VERSION", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^#define FILETRACE_VERSION /", "file": true, "language": "C++", "kind": "macro"}, {"_type": "tag", "name": "FileOperation", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^struct FileOperation {$/", "file": true, "language": "C++", "kind": "struct"}, {"_type": "tag", "name": "PROCESS", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^    PROCESS,$/", "file": true, "language": "C++", "kind": "enumerator", "scope": "ProcessType", "scopeKind": "enum"}, {"_type": "tag", "name": "ProcessType", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^enum class ProcessType {$/", "file": true, "language": "C++", "kind": "enum"}, {"_type": "tag", "name": "THREAD", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^    THREAD$/", "file": true, "language": "C++", "kind": "enumerator", "scope": "ProcessType", "scopeKind": "enum"}, {"_type": "tag", "name": "ThreadInfo", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^struct ThreadInfo {$/", "file": true, "language": "C++", "kind": "struct"}, {"_type": "tag", "name": "__anonaff9c033010a", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^    union {$/", "file": true, "language": "C++", "kind": "union", "scope": "read_process_string", "scopeKind": "function"}, {"_type": "tag", "name": "active", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^    bool active;$/", "file": true, "language": "C++", "typeref": "typename:bool", "kind": "member", "scope": "ThreadInfo", "scopeKind": "struct"}, {"_type": "tag", "name": "chars", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^        char chars[sizeof(long)];$/", "file": true, "language": "C++", "typeref": "typename:char[]", "kind": "member", "scope": "read_process_string::__anonaff9c033010a", "scopeKind": "union"}, {"_type": "tag", "name": "child_processes", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^    std::vector<pid_t> child_processes;$/", "file": true, "language": "C++", "typeref": "typename:std::vector<pid_t>", "kind": "member", "scope": "ThreadInfo", "scopeKind": "struct"}, {"_type": "tag", "name": "child_threads", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^    std::vector<pid_t> child_threads;$/", "file": true, "language": "C++", "typeref": "typename:std::vector<pid_t>", "kind": "member", "scope": "ThreadInfo", "scopeKind": "struct"}, {"_type": "tag", "name": "creation_time", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^    time_t creation_time;$/", "file": true, "language": "C++", "typeref": "typename:time_t", "kind": "member", "scope": "ThreadInfo", "scopeKind": "struct"}, {"_type": "tag", "name": "display_help", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^void display_help(const cxxopts::Options& options) {$/", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "(const cxxopts::Options & options)"}, {"_type": "tag", "name": "exit_status", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^    int exit_status;$/", "file": true, "language": "C++", "typeref": "typename:int", "kind": "member", "scope": "ThreadInfo", "scopeKind": "struct"}, {"_type": "tag", "name": "generate_html_output", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^void generate_html_output(const std::vector<FileOperation>& operations, const std::string& outpu/", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "(const std::vector<FileOperation> & operations,const std::string & output_file)"}, {"_type": "tag", "name": "get_thread_name", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^std::string get_thread_name(pid_t tid) {$/", "language": "C++", "typeref": "typename:std::string", "kind": "function", "signature": "(pid_t tid)"}, {"_type": "tag", "name": "handle_syscall_entry", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^void handle_syscall_entry(pid_t pid, const user_regs_struct& regs, std::vector<FileOperation>& o/", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "(pid_t pid,const user_regs_struct & regs,std::vector<FileOperation> & operations,const std::string & base_dir=\"\")"}, {"_type": "tag", "name": "handle_thread_creation", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^void handle_thread_creation(pid_t parent_pid, pid_t thread_id, bool is_process = false) {$/", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "(pid_t parent_pid,pid_t thread_id,bool is_process=false)"}, {"_type": "tag", "name": "handle_thread_exit", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^void handle_thread_exit(pid_t thread_id, int exit_status = 0) {$/", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "(pid_t thread_id,int exit_status=0)"}, {"_type": "tag", "name": "is_actual_open", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^    bool is_actual_open;  \\/\\/ Distinguish between actual opens and execve lookups$/", "file": true, "language": "C++", "typeref": "typename:bool", "kind": "member", "scope": "FileOperation", "scopeKind": "struct"}, {"_type": "tag", "name": "main", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^int main(int argc, char* argv[]) try {$/", "language": "C++", "typeref": "typename:int", "kind": "function", "signature": "(int argc,char * argv[])"}, {"_type": "tag", "name": "name", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^    std::string name;$/", "file": true, "language": "C++", "typeref": "typename:std::string", "kind": "member", "scope": "ThreadInfo", "scopeKind": "struct"}, {"_type": "tag", "name": "parent_pid", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^    pid_t parent_pid;$/", "file": true, "language": "C++", "typeref": "typename:pid_t", "kind": "member", "scope": "ThreadInfo", "scopeKind": "struct"}, {"_type": "tag", "name": "path", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^    std::string path;$/", "file": true, "language": "C++", "typeref": "typename:std::string", "kind": "member", "scope": "FileOperation", "scopeKind": "struct"}, {"_type": "tag", "name": "pid", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^    pid_t pid;$/", "file": true, "language": "C++", "typeref": "typename:pid_t", "kind": "member", "scope": "FileOperation", "scopeKind": "struct"}, {"_type": "tag", "name": "process_type", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^    ProcessType process_type;$/", "file": true, "language": "C++", "typeref": "typename:ProcessType", "kind": "member", "scope": "ThreadInfo", "scopeKind": "struct"}, {"_type": "tag", "name": "read_process_string", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^std::string read_process_string(pid_t pid, unsigned long addr) {$/", "language": "C++", "typeref": "typename:std::string", "kind": "function", "signature": "(pid_t pid,unsigned long addr)"}, {"_type": "tag", "name": "resolve_fd_path", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^std::string resolve_fd_path(pid_t pid, int fd) {$/", "language": "C++", "typeref": "typename:std::string", "kind": "function", "signature": "(pid_t pid,int fd)"}, {"_type": "tag", "name": "resolve_relative_path", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^std::string resolve_relative_path(const std::string& base_path, const std::string& relative_path/", "language": "C++", "typeref": "typename:std::string", "kind": "function", "signature": "(const std::string & base_path,const std::string & relative_path)"}, {"_type": "tag", "name": "sequence", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^    int sequence;$/", "file": true, "language": "C++", "typeref": "typename:int", "kind": "member", "scope": "FileOperation", "scopeKind": "struct"}, {"_type": "tag", "name": "thread_id", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^    pid_t thread_id;$/", "file": true, "language": "C++", "typeref": "typename:pid_t", "kind": "member", "scope": "FileOperation", "scopeKind": "struct"}, {"_type": "tag", "name": "thread_id", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^    pid_t thread_id;$/", "file": true, "language": "C++", "typeref": "typename:pid_t", "kind": "member", "scope": "ThreadInfo", "scopeKind": "struct"}, {"_type": "tag", "name": "thread_map", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^std::map<pid_t, ThreadInfo> thread_map;$/", "language": "C++", "typeref": "typename:std::map<pid_t,ThreadInfo>", "kind": "variable"}, {"_type": "tag", "name": "thread_map_mutex", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^std::mutex thread_map_mutex;$/", "language": "C++", "typeref": "typename:std::mutex", "kind": "variable"}, {"_type": "tag", "name": "thread_name", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^    std::string thread_name;$/", "file": true, "language": "C++", "typeref": "typename:std::string", "kind": "member", "scope": "FileOperation", "scopeKind": "struct"}, {"_type": "tag", "name": "val", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^        long val;$/", "file": true, "language": "C++", "typeref": "typename:long", "kind": "member", "scope": "read_process_string::__anonaff9c033010a", "scopeKind": "union"}, {"_type": "tag", "name": "validate_command", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^bool validate_command(const std::string& command) {$/", "language": "C++", "typeref": "typename:bool", "kind": "function", "signature": "(const std::string & command)"}, {"_type": "tag", "name": "validate_output_file", "path": "/home/kavia/workspace/code-generation/filetrace/src/main.cpp", "pattern": "/^bool validate_output_file(const std::string& path) {$/", "language": "C++", "typeref": "typename:bool", "kind": "function", "signature": "(const std::string & path)"}], "hash": "88b1a821185433b42c2218fbe77cdc08", "format-version": 4, "code-base-name": "filetrace", "filename": "src/main.cpp", "fields": [{"name": "bool active", "scope": "ThreadInfo", "scopeKind": "struct", "description": "unavailable"}, {"name": "char[] chars", "scope": "read_process_string::__anonaff9c033010a", "scopeKind": "union", "description": "unavailable"}, {"name": "std::vector<pid_t> child_processes", "scope": "ThreadInfo", "scopeKind": "struct", "description": "unavailable"}, {"name": "std::vector<pid_t> child_threads", "scope": "ThreadInfo", "scopeKind": "struct", "description": "unavailable"}, {"name": "time_t creation_time", "scope": "ThreadInfo", "scopeKind": "struct", "description": "unavailable"}, {"name": "int exit_status", "scope": "ThreadInfo", "scopeKind": "struct", "description": "unavailable"}, {"name": "bool is_actual_open", "scope": "FileOperation", "scopeKind": "struct", "description": "unavailable"}, {"name": "std::string name", "scope": "ThreadInfo", "scopeKind": "struct", "description": "unavailable"}, {"name": "pid_t parent_pid", "scope": "ThreadInfo", "scopeKind": "struct", "description": "unavailable"}, {"name": "std::string path", "scope": "FileOperation", "scopeKind": "struct", "description": "unavailable"}, {"name": "pid_t pid", "scope": "FileOperation", "scopeKind": "struct", "description": "unavailable"}, {"name": "ProcessType process_type", "scope": "ThreadInfo", "scopeKind": "struct", "description": "unavailable"}, {"name": "int sequence", "scope": "FileOperation", "scopeKind": "struct", "description": "unavailable"}, {"name": "pid_t thread_id", "scope": "FileOperation", "scopeKind": "struct", "description": "unavailable"}, {"name": "std::map<pid_t,ThreadInfo> thread_map", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "std::mutex thread_map_mutex", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "std::string thread_name", "scope": "FileOperation", "scopeKind": "struct", "description": "unavailable"}, {"name": "long val", "scope": "read_process_string::__anonaff9c033010a", "scopeKind": "union", "description": "unavailable"}], "revision_history": [{"190": "752b0fb5cc733008c1ffde3c54134ff699070bc7"}]}