{"is_source_file": true, "format": "C++", "description": "A complex C++ source file implementing a thread-aware file access tracer using ptrace, handling process and thread creation, termination, file operations, and generating an HTML report.", "external_files": ["path_utils.hpp", "directory_tree.hpp", "html_generator.hpp", "logger.hpp"], "external_methods": ["path_utils::normalize_path", "path_utils::is_within_directory", "path_utils::get_current_directory", "HtmlGenerator::generate_html_report", "HtmlGenerator::get_last_error", "Logger::debug", "Logger::error", "Logger::warning", "Logger::info"], "published": ["FILETRACE_VERSION", "ProcessType", "ThreadInfo", "FileOperation", "get_thread_name", "handle_thread_creation", "handle_thread_exit", "resolve_fd_path", "resolve_relative_path", "read_process_string", "handle_syscall_entry", "generate_html_output", "validate_output_file", "validate_command", "display_help"], "classes": [{"name": "ProcessType", "description": "Enum to distinguish between processes and threads"}, {"name": "ThreadInfo", "description": "Structure to store thread or process information including IDs, parent, name, activity status, children, creation time, and exit status"}, {"name": "FileOperation", "description": "Structure to store details of a file operation including process ID, path, sequence, thread ID, thread name, and whether it is an actual open"}], "methods": [{"name": "get_thread_name", "description": "Retrieves the thread name from /proc filesystem"}, {"name": "handle_thread_creation", "description": "Handles creation of a new thread or process, updating thread map and parent-child relationships"}, {"name": "handle_thread_exit", "description": "Handles cleanup and state update when a thread or process exits"}, {"name": "resolve_fd_path", "description": "Resolves the file descriptor path for a given process and file descriptor"}, {"name": "resolve_relative_path", "description": "Resolves relative paths based on a base directory"}, {"name": "read_process_string", "description": "Reads a null-terminated string from a process's memory using ptrace"}, {"name": "handle_syscall_entry", "description": "Processes system call entry events, handling process/thread creation, exit, and file operations"}, {"name": "generate_html_output", "description": "Generates an HTML report of file operations"}, {"name": "validate_output_file", "description": "Validates if the output file path is writable and valid"}, {"name": "validate_command", "description": "Checks if the command exists and is executable"}, {"name": "display_help", "description": "Displays help message with usage examples"}], "calls": ["ptrace(PTRACE_DETACH)", "ptrace(PTRACE_PEEKDATA)", "ptrace(PTRACE_GETREGS)", "ptrace(PTRACE_SETOPTIONS)", "ptrace(PTRACE_SYSCALL)", "waitpid", "kill", "stat", "access", "readlink", "getenv", "std::filesystem::exists", "std::filesystem::is_directory", "std::filesystem::status", "HtmlGenerator::generate_html_report", "Logger::debug", "Logger::error", "Logger::warning", "Logger::info"], "search-terms": ["ptrace", "thread tracking", "file operations", "system call interception", "HTML report generation", "process and thread management", "clone/fork/vfork handling", "file descriptor resolution", "system call handling", "multi-threaded process tracing"], "state": 2, "file_id": 16, "knowledge_revision": 67, "git_revision": "752b0fb5cc733008c1ffde3c54134ff699070bc7", "revision_history": [{"50": "06eb75e40164864b88d77b971a4a95be232768ca"}, {"67": "752b0fb5cc733008c1ffde3c54134ff699070bc7"}], "ctags": [], "filename": "src/main.cpp", "format-version": 4, "code-base-name": "https://github.com/Kavia-ai/filetrace.git:cga-cm68d71d5a"}